<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>D3 test</title>
	<script type="text/javascript" src="d3.js"></script>
	<script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
	<style type="text/css">
		
		.aligned {
			text-align: center;
		}

		.d3-tip {
		  line-height: 1;
		  font-weight: bold;
		  padding: 12px;
		  background: rgba(0, 0, 0, 0.8);
		  color: #fff;
		  border-radius: 2px;
		}
	</style>
</head>
<body>
	<script type="text/javascript">
		d3.select("head")	
			.select("title")
			.text("Barchart");
	</script>
	<script type="text/javascript">
		var body = d3.select("body");

		d3.json("/burnoutData.json").then(function(data) {
			

			// Set SVG and graph properties
			var dataset = data;
			var keys = Object.keys(dataset);
			var lengthData = keys.length;
			var margin = {top: 20, right: 20, bottom: 70, left: 40};
			var w = 600;
			var h = 400;
			var wb = 25;	
			var padding = 100;
					
			// Create SVG
			var svg = body.append("svg")
						    .attr("width", w)
						    .attr("height", h)
						  .append("g")
						    .attr("transform",
						    	 "translate(" + margin.left + "," + margin.top + ")");		
			

			// Set scales
			var xScale = d3.scaleOrdinal()
						     .domain(keys)
						     .range([300,340,380,420,460,500]);
			var yScale = d3.scaleLinear()
						     .domain([0,100])
						     .range([0,h]);

			// Create bar graph
			svg.selectAll("rect")
			   .data(keys)
			   .enter()
			   .append("rect")
			     .attr("x", function(d){
			       return xScale(d);
			     })
			     .attr("y", function(d) {
			       //return h - (dataset[d]["Burn-out klachten/Burn-out klachten (%)"] * 10);
			       return yScale(dataset[d]["Burn-out klachten/Burn-out klachten (%)"]);
			     })
			     .attr("width", wb)
			     .attr("height", function(d,i){
			       //return dataset[d]["Burn-out klachten/Burn-out klachten (%)"] * 10;
			       return h - yScale(dataset[d]["Burn-out klachten/Burn-out klachten (%)"]);
			     })
			     .attr("fill", function(d){
			   	   return "rgb(" + dataset[d]["Burn-out klachten/Burn-out klachten (%)"] * 10 + ",0,0)";
			     })

			svg.append("g")
			     .attr("class", "x-axis")
			     .attr("transform", "translate(0," + (h - margin.top - margin.bottom) + ")")
			     .call(d3.axisBottom(xScale));
			svg.append("g")
			     .attr("class", "y-axis")
			     .attr("transform", "translate(" + 280 + ",0)")
			     .call(d3.axisLeft(yScale));

			var tip = d3.tip()
			   .attr("class", "d3-tip")
			   .offset([-10,0])
			   .html(function(d) { "<strong>Percentage:</strong> <span style='color:red'>" + dataset[d]["Burn-out klachten/Burn-out klachten (%)"] + "</span>";
			   });

			svg.call(tip);
		});		


		// Set lay-out html page
		body
		  .append("title")
		  .text("barchart");
		body
		  .append("h1")
		  .attr("class", "aligned")
		  .text("Week 4")
		  .style("text-align", "center");
		body
		  .append("h2")
		  .attr("class", "aligned")
		  .text("Barchart assignment");		  
		body
		  .append("p")
		  .text("Name: EX Oosterbaan")
		  .style("color", "blue");		  
		body
		  .append("p")
		  .text("Studentnr: 10549579");			
		body
		  .append("p")
		  .text("The data was aquired via cbs.nl and constitutes of health data of the Dutch working population");
		  body
		    .append("h2")
		    .attr("class", "aligned")
		    .text("Graph");
	</script>
</body>
</html>